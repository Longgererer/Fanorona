(this.webpackJsonpfanorona=this.webpackJsonpfanorona||[]).push([[0],{13:function(e,s,a){e.exports={chessBox:"src-components-chess-chess-chessBox-bed6c",passable:"src-components-chess-chess-passable-3dd4c",roll:"src-components-chess-chess-roll-77673",usable:"src-components-chess-chess-usable-02c0e",usableActive:"src-components-chess-chess-usableActive-82772",clickActive:"src-components-chess-chess-clickActive-fe571",removable:"src-components-chess-chess-removable-c7902"}},132:function(e,s,a){"use strict";a.r(s);var t=a(0),n=a.n(t),o=a(11),r=a.n(o),c=(a(78),a(64)),i=a(8),l=a(20),h=a(21),u=a(22),f=a(23),v=a(32),b=a.n(v),m=a(13),p=a.n(m),d=function(e){Object(f.a)(a,e);var s=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=s.call(this)).printInfo=function(){var s=e.props,a=s.chessInfo;a.passable&&s.moveChess(a),a.usable&&s.updateActiveChess(a),a.removable&&s.cleanRemovableChess(a)},e.mouseEnter=function(){e.setState({isHover:!0})},e.mouseLeave=function(){e.setState({isHover:!1})},e.state={isHover:!1},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props.chessInfo,s=this.state.isHover,a="."+("black"===e.player?"/black.svg":"/white.svg"),t=e.usable?s?p.a.usableActive:p.a.usable:"",o=e.isActive?p.a.clickActive:"",r=e.removable?p.a.removable:"";return n.a.createElement("div",{className:"".concat(p.a.chessBox," flex flex-1 flex-ai flex-jcc"),onClick:this.printInfo,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},"none"!==e.player&&n.a.createElement("img",{className:"".concat(t," ").concat(o," ").concat(r),src:a,alt:""}),e.passable&&this.state.isHover&&n.a.createElement("div",{className:p.a.passable}),e.isForbid&&n.a.createElement("img",{src:"".concat(".","/forbid.svg"),alt:""}))}}]),a}(n.a.Component),y=a(65),x=a.n(y),g=a(134),C=function(e){Object(f.a)(a,e);var s=Object(u.a)(a);function a(e){return Object(l.a)(this,a),s.call(this,e)}return Object(h.a)(a,[{key:"render",value:function(){var e=this.props,s=e.startGame,a=e.started,t=e.gameOver,o=e.nextTurn,r=e.combo;return n.a.createElement("div",{className:x.a.Options},a&&n.a.createElement(g.a,{type:"danger",onClick:function(){return t()}},"Give up"),r&&n.a.createElement(g.a,{type:"danger",onClick:o},"Next turn"),!a&&n.a.createElement(g.a,{type:"primary",onClick:s},"Start!"),a&&n.a.createElement(g.a,{type:"primary",onClick:s},"Restart"),n.a.createElement(g.a,{type:"dashed"},n.a.createElement("a",{href:"https://github.com/Longgererer/Fanorona#%E6%B8%B8%E6%88%8F%E8%A7%84%E5%88%99",target:"black"},"Help")))}}]),a}(n.a.Component),k=function(e){Object(f.a)(a,e);var s=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=s.call(this)).startGame=function(){e.setState({chessInfo:e.initChessInfo(),whoseTurn:"white",started:!0,combo:!1,eatable:!0,blackNum:22,whiteNum:22,activeChess:{},forbidList:[],usableList:[]},(function(){e.judgeUsableChess()}))},e.gameOver=function(s){console.log(s);var a=s||("black"===e.state.whoseTurn?"white":"black");console.log(a),e.setState({chessInfo:[],blackNum:0,whiteNum:0,started:!1,activeChess:{},eatable:!0,forbidList:[],usableList:[],combo:!1},(function(){alert("".concat(a," win!!!"))}))},e.nextTurn=function(){var s=e.state,a=s.usableList,t=s.activeChess,n=s.chessInfo;if(Object.keys(t).length){var o=t.x,r=t.y;n[r][o].usable=!1,n[r][o].isActive=!1}a.forEach((function(e){e.usable=!1})),e.setState({combo:!1,eatable:!0}),e.updateTurn()},e.updateActiveChess=function(s){var a=e.state,t=a.chessInfo,n=a.activeChess;if(s.usable){if(Object.keys(n).length){var o=n.x;t[n.y][o].isActive=!1}var r=s.x,c=s.y;t[c][r].isActive=!0,e.setState({chessInfo:t,activeChess:{x:r,y:c}},(function(){e.getPassablePos(s)}))}},e.moveChess=function(s){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2?arguments[2]:void 0,n=e.state,o=n.chessInfo,r=n.whoseTurn,c=n.activeChess,l=s.x,h=s.y,u=a?c:t,f=u.x,v=u.y,b=l-f,m=h-v,p=o[v][f];if(a){s.passable=!1,s.player=r,p.player="none",p.isActive=!1;for(var d=0;d<5;d++)for(var y=0;y<9;y++){var x=o[d][y];x.player===r&&x.usable&&(x.usable=!1)}e.setState({chessInfo:o})}var g="black"===r?"white":"black",C=l+b,k=h+m,E=f-b,j=v-m,O=!1,w=!1;if(e.judgeChessSave(C,k)&&o[k][C].player===g&&(O=!0),e.judgeChessSave(E,j)&&o[j][E].player===g&&(w=!0),!a)return O||w;var I=[],L=[];if(O&&(I=e.getRemovableChess(g,"front",{x:b,y:m},{x:l,y:h})),w&&(L=e.getRemovableChess(g,"after",{x:b,y:m},{x:f,y:v})),O&&w){var N=[].concat(Object(i.a)(I),Object(i.a)(L));N.forEach((function(e){e.removable=!0})),e.setState({frontList:I,afterList:L})}else{if(!O&&!w)return void e.updateTurn();var S=[].concat(Object(i.a)(I),Object(i.a)(L));S.forEach((function(e){e.player="none"})),e.updateChessNum();var T=e.judgeCombo(s,p);T?(s.usable=!0,e.handleForbid(p)):(e.handleForbid(p),e.updateTurn())}},e.cleanRemovableChess=function(s){var a=e.state,t=a.frontList,n=a.afterList;t.indexOf(s)>=0&&(t.forEach((function(e){e.player="none"})),n.forEach((function(e){e.removable=!1}))),n.indexOf(s)>=0&&(n.forEach((function(e){e.player="none"})),t.forEach((function(e){e.removable=!1}))),e.updateChessNum(),e.updateTurn()},e.judgeUsableChess=function(){for(var s=e.state,a=s.whoseTurn,t=s.chessInfo,n=[],o=0;o<5;o++)for(var r=0;r<9;r++){var c=t[o][r];"none"===c.player&&n.push(c)}for(var l=[],h=[],u=0,f=n.length;u<f;u++){var v=n[u],b=l.length,m=v.x,p=v.y;p&&l.push(t[p-1][m]),m&&l.push(t[p][m-1]),4!==p&&l.push(t[p+1][m]),8!==m&&l.push(t[p][m+1]),(p+m)%2===0&&(p&&m&&l.push(t[p-1][m-1]),4!==p&&8!==m&&l.push(t[p+1][m+1]),p&&8!==m&&l.push(t[p-1][m+1]),4!==p&&m&&l.push(t[p+1][m-1]));var d=e.judgeEatableChess(l.slice(b),v);h=[].concat(Object(i.a)(h),Object(i.a)(d))}h.length?l=h:e.setState({eatable:!1});for(var y=l.length;y--;)l[y].player===a&&(l[y].usable=!0);e.setState({usableList:l})},e.state={chessInfo:[],whoseTurn:"white",usableList:[],blackNum:0,whiteNum:0,activeChess:{},frontList:[],afterList:[],forbidList:[],combo:!1,eatable:!0,started:!1},e}return Object(h.a)(a,[{key:"updateTurn",value:function(){var e=this,s=this.state,a=s.whoseTurn,t=s.chessInfo;a="black"===a?"white":"black";for(var n=0;n<5;n++)for(var o=0;o<9;o++){var r=t[n][o];r.passable&&(r.passable=!1)}this.setState({whoseTurn:a,chessInfo:t,combo:!1,eatable:!0,activeChess:[]},(function(){e.handleForbid(),e.judgeUsableChess()}))}},{key:"updateChessNum",value:function(){for(var e=this.state,s="black"===e.whoseTurn?"white":"black",a=e.chessInfo,t=0,n=0;n<5;n++)for(var o=0;o<9;o++)a[n][o].player===s&&t++;if(t){var r="black"===s?"blackNum":"whiteNum";this.setState(Object(c.a)({},r,t))}else this.gameOver(e.whoseTurn)}},{key:"getPassablePos",value:function(e){for(var s=this.state,a=s.chessInfo,t=s.forbidList,n=s.eatable,o=[],r=0;r<5;r++)for(var c=0;c<9;c++){var i=a[r][c];"none"===i.player&&o.push(i)}for(var l=e.x,h=e.y,u=0,f=o.length;u<f;u++){var v=o[u];if(!v.isForbid){var b=v.x,m=v.y;if(t.length){var p=t[t.length-1];if((p.x+b)/2===l&&(p.y+m)/2===h)continue}if(v.passable=!1,(l+h)%2===0)if(b===l+1||b===l-1)if(m===h+1||m===h-1)(this.moveChess(v,!1,e)||!n)&&(v.passable=!0);if(b===l&&(m===h-1||m===h+1))(this.moveChess(v,!1,e)||!n)&&(v.passable=!0);if(m===h&&(b===l-1||b===l+1))(this.moveChess(v,!1,e)||!n)&&(v.passable=!0)}}}},{key:"judgeCombo",value:function(e,s){for(var a=this.state.chessInfo,t=e.x,n=e.y,o=[],r=-1;r<2;r++)for(var c=-1;c<2;c++)(t+n)%2===1?r!==c&&o.push({x:c+t,y:r+n}):(r||c)&&o.push({x:c+t,y:r+n});for(var i=o.length-1;i>=0;i--){var l=o[i],h=l.x,u=l.y;if(this.judgeChessSave(h,u)){var f=s.x,v=s.y,b=2*t-f,m=2*n-v,p=a[u][h];("none"!==p.player||p.isForbid||h===f&&u===v||h===b&&u===m)&&o.splice(i,1)}else o.splice(i,1)}if(!o.length)return!1;for(var d=0,y=o.length;d<y;d++){var x=o[d],g=a[x.y][x.x];if(this.moveChess(g,!1,e))return this.setState({combo:!0}),!0}return!1}},{key:"handleForbid",value:function(e){var s=this.state.forbidList;e?(e.isForbid=!0,this.setState({forbidList:[].concat(Object(i.a)(s),[e])})):(s.forEach((function(e){e.isForbid=!1,e.usable=!1})),this.setState({forbidList:[]}))}},{key:"getRemovableChess",value:function(e,s,a,t){var n=this.state.chessInfo,o=a.x,r=a.y;"front"!==s&&(o=-o,r=-r);for(var c=o<0?0:0===o?100:8,i=r<0?0:0===r?100:4,l=t.x,h=t.y,u=Math.abs(c-l),f=Math.abs(i-h),v=u<f?u:f,b=[],m=0;m<v;m++){l+=o;var p=n[h+=r][l];if(p.player!==e)break;b.push(p)}return b}},{key:"judgeChessSave",value:function(e,s){return e>=0&&e<=8&&s>=0&&s<=4}},{key:"initChessInfo",value:function(){for(var e=[],s=0;s<5;s++){for(var a=[],t=0;t<9;t++){var n={id:"".concat(t).concat(s),x:t,y:s,player:"white",usable:!1,isForbid:null,passable:!1,isActive:!1,removable:!1};s<=1&&(n.player="black");2===s&&-1!==[0,2,5,7].indexOf(t)&&(n.player="black"),2===s&&4===t&&(n.player="none"),a.push(n)}e.push(a)}return e}},{key:"judgeEatableChess",value:function(e,s){var a=this,t=this.state.whoseTurn,n=[];return e.forEach((function(e){e.player===t&&(a.moveChess(s,!1,e)&&n.push(e))})),n}},{key:"render",value:function(){var e=this,s=this.state,a=s.started,t=s.chessInfo,o=s.combo;return n.a.createElement("div",{className:"flex flex-ai flex-jcc flex-clo"},n.a.createElement(C,{startGame:this.startGame,started:a,combo:o,gameOver:this.gameOver,nextTurn:this.nextTurn}),n.a.createElement("div",{className:"".concat(b.a.Chessboard," flex flex-ai flex-jcc")},n.a.createElement("img",{className:b.a.boardImg,src:"".concat(".","/chessboard.svg"),alt:""}),n.a.createElement("div",{className:"".concat(b.a.screenBox," flex flex-clo")},t.map((function(s,a){return n.a.createElement("div",{className:"flex flex-1",key:a},s.map((function(s){return n.a.createElement(d,{chessInfo:s,key:s.id,updateActiveChess:e.updateActiveChess,moveChess:e.moveChess,cleanRemovableChess:e.cleanRemovableChess})})))})))))}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}));var E=n.a.createElement("div",{className:"App noselect flex flex-ai flex-jcc flex-clo"},n.a.createElement(k,null));r.a.render(E,document.getElementById("root"))},32:function(e,s,a){e.exports={Chessboard:"src-components-chessboard-chessboard-Chessboard-d1ef7",boardImg:"src-components-chessboard-chessboard-boardImg-4595e",screenBox:"src-components-chessboard-chessboard-screenBox-811f4",chessBox:"src-components-chessboard-chessboard-chessBox-80a80"}},65:function(e,s,a){e.exports={Options:"src-components-options-options-Options-9cf4e"}},73:function(e,s,a){e.exports=a(132)},78:function(e,s,a){}},[[73,1,2]]]);
//# sourceMappingURL=main.0a5b3941.chunk.js.map